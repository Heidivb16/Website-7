<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HLA Fitness - Social Fitness App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            min-height: 100vh;
            padding: 20px;
            color: #ffffff;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #B8A4D4;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-tab {
            padding: 12px 24px;
            background: rgba(184, 164, 212, 0.1);
            border: 2px solid rgba(184, 164, 212, 0.3);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
        }

        .nav-tab:hover {
            background: rgba(184, 164, 212, 0.2);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: #B8A4D4;
            color: black;
            border-color: #B8A4D4;
        }

        .content-section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: #2d2d2d;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid #3d3d3d;
        }

        .card h2 {
            color: #B8A4D4;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #cccccc;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #3d3d3d;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            background: #1a1a1a;
            color: white;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #B8A4D4;
        }

        .form-group input:disabled,
        .form-group select:disabled {
            background: #2d2d2d;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .btn {
            padding: 12px 30px;
            background: #B8A4D4;
            color: black;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            margin-right: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            background: #d4c4ec;
        }

        .btn-secondary {
            background: #3d3d3d;
            color: white;
        }

        .btn-secondary:hover {
            background: #4d4d4d;
        }

        .btn-small {
            padding: 5px 12px;
            font-size: 14px;
            margin-left: 5px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #B8A4D4 0%, #d4c4ec 100%);
            color: black;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .stat-card p {
            font-weight: 600;
        }

        .water-bottle-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 30px 0;
        }

        .water-bottle {
            width: 120px;
            height: 300px;
            background: linear-gradient(to bottom, #1a1a1a 0%, #2d2d2d 100%);
            border: 4px solid #B8A4D4;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .water-level {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to bottom, #B8A4D4 0%, #d4c4ec 100%);
            height: 0%;
            transition: height 0.3s;
        }

        .water-slider {
            width: 300px;
            margin: 20px 0;
            -webkit-appearance: none;
            appearance: none;
            height: 8px;
            background: #3d3d3d;
            border-radius: 5px;
            outline: none;
        }

        .water-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #B8A4D4;
            cursor: pointer;
            border-radius: 50%;
        }

        .water-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #B8A4D4;
            cursor: pointer;
            border-radius: 50%;
            border: none;
        }

        .water-stats {
            text-align: center;
            margin-top: 15px;
        }

        .water-stats h3 {
            color: #B8A4D4;
            font-size: 2em;
        }

        .progress-bar-container {
            width: 100%;
            background: #1a1a1a;
            border-radius: 10px;
            height: 30px;
            margin: 15px 0;
            position: relative;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(135deg, #B8A4D4 0%, #d4c4ec 100%);
            border-radius: 10px;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: black;
            font-weight: 700;
        }

        .calendar-container {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .calendar-day {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #3d3d3d;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .calendar-day.today {
            border-color: #B8A4D4;
        }

        .calendar-day.has-data {
            background: rgba(184, 164, 212, 0.2);
        }

        .calendar-day-number {
            font-weight: bold;
            color: #B8A4D4;
            margin-bottom: 5px;
        }

        .calendar-day-label {
            font-size: 0.8em;
            color: #888;
        }

        .calendar-day-value {
            font-size: 0.9em;
            color: white;
            margin-top: 5px;
        }

        .sports-history {
            margin-top: 20px;
        }

        .sport-entry {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #B8A4D4;
            position: relative;
        }

        .sport-entry h4 {
            color: #B8A4D4;
            margin-bottom: 5px;
        }

        .sport-entry-actions {
            position: absolute;
            top: 15px;
            right: 15px;
        }

        .recommendation-box {
            background: rgba(184, 164, 212, 0.1);
            border: 2px solid #B8A4D4;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .recommendation-box h3 {
            color: #B8A4D4;
            margin-bottom: 10px;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .profile-header {
            background: linear-gradient(135deg, #B8A4D4 0%, #d4c4ec 100%);
            color: black;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            position: relative;
        }

        .profile-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: white;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            color: #B8A4D4;
            position: relative;
            cursor: pointer;
            overflow: hidden;
            border: 4px solid #B8A4D4;
            transition: all 0.3s;
        }

        .profile-avatar:hover {
            border-color: #d4c4ec;
            transform: scale(1.05);
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-avatar.dragging {
            border: 4px dashed #B8A4D4;
            background: rgba(184, 164, 212, 0.2);
        }

        .upload-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            color: #B8A4D4;
            font-size: 0.9em;
            text-align: center;
            padding: 10px;
        }

        .profile-avatar:hover .upload-overlay {
            display: flex;
        }

        .edit-profile-btn {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .profile-display {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .profile-field {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #3d3d3d;
        }

        .profile-field:last-child {
            border-bottom: none;
        }

        .profile-field-label {
            color: #888;
            font-weight: 600;
        }

        .profile-field-value {
            color: white;
            font-weight: 500;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .month-selector {
            background: #1a1a1a;
            color: white;
            border: 2px solid #3d3d3d;
            padding: 8px 15px;
            border-radius: 8px;
        }

        .workout-indicator {
            width: 8px;
            height: 8px;
            background: #B8A4D4;
            border-radius: 50%;
            margin: 2px auto;
        }

        .hidden {
            display: none;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 1.8em;
            color: #B8A4D4;
            font-weight: 600;
        }

        .badge {
            background: #B8A4D4;
            color: #000000;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 700;
        }

        .friend-request-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-label {
            font-size: 1em;
            font-weight: 600;
            color: #cccccc;
        }

        .form-input {
            width: 100%;
            padding: 14px 18px;
            font-size: 1em;
            border: 2px solid #3d3d3d;
            border-radius: 10px;
            background: #1a1a1a;
            color: #ffffff;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #B8A4D4;
            background: #252525;
        }

        .form-input::placeholder {
            color: #666666;
        }

        .confirmation-message {
            min-height: 40px;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.95em;
            display: none;
        }

        .confirmation-message.success {
            display: block;
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4caf50;
            color: #4caf50;
        }

        .confirmation-message.error {
            display: block;
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid #f44336;
            color: #f44336;
        }

        .btn-icon {
            font-size: 1.1em;
        }

        .btn-accept {
            background: #4caf50;
            color: #ffffff;
            flex: 1;
        }

        .btn-accept:hover {
            background: #5bc75f;
        }

        .btn-deny {
            background: #f44336;
            color: #ffffff;
            flex: 1;
        }

        .btn-deny:hover {
            background: #f55a4e;
        }

        .btn-cancel {
            background: #666666;
            color: #ffffff;
        }

        .btn-cancel:hover {
            background: #777777;
        }

        .btn-message {
            background: #B8A4D4;
            color: #000000;
            flex: 1;
        }

        .btn-message:hover {
            background: #d4c4ec;
        }

        .requests-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .request-card {
            background: #2d2d2d;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            border: 2px solid #3d3d3d;
            transition: all 0.3s ease;
        }

        .request-card:hover {
            border-color: #B8A4D4;
            transform: translateX(5px);
        }

        .request-card.outgoing {
            border-left: 4px solid #B8A4D4;
        }

        .request-avatar {
            flex-shrink: 0;
        }

        .avatar-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #B8A4D4 0%, #d4c4ec 100%);
            color: #000000;
            font-size: 1.3em;
            font-weight: 700;
        }

        .avatar-placeholder.large {
            width: 80px;
            height: 80px;
            font-size: 1.6em;
        }

        .request-info {
            flex: 1;
        }

        .request-name {
            font-size: 1.2em;
            color: #ffffff;
            margin-bottom: 4px;
            font-weight: 600;
        }

        .request-meta {
            font-size: 0.9em;
            color: #888888;
            margin-bottom: 4px;
        }

        .request-details {
            font-size: 0.9em;
            color: #cccccc;
        }

        .request-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-top: 4px;
        }

        .request-status.pending {
            background: rgba(184, 164, 212, 0.2);
            color: #B8A4D4;
        }

        .request-actions {
            display: flex;
            gap: 10px;
            flex-shrink: 0;
        }

        .friends-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .friend-card {
            background: #2d2d2d;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #3d3d3d;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .friend-card:hover {
            border-color: #B8A4D4;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(184, 164, 212, 0.2);
        }

        .friend-avatar {
            margin-bottom: 15px;
        }

        .friend-info {
            margin-bottom: 20px;
        }

        .friend-name {
            font-size: 1.3em;
            color: #ffffff;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .friend-username {
            font-size: 0.9em;
            color: #888888;
        }

        .friend-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            padding: 15px;
            background: #1a1a1a;
            border-radius: 10px;
            width: 100%;
        }

        .stat-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .stat-value {
            font-size: 1.1em;
            color: #B8A4D4;
            font-weight: 700;
        }

        .stat-label {
            font-size: 0.8em;
            color: #888888;
        }

        .friend-actions {
            display: flex;
            gap: 10px;
            width: 100%;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background: #2d2d2d;
            border-radius: 15px;
            border: 2px dashed #3d3d3d;
        }

        .empty-icon {
            font-size: 4em;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .empty-text {
            font-size: 1.1em;
            color: #888888;
        }

        .goal-edit-section {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .goal-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #2d2d2d;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .goal-label {
            color: #B8A4D4;
            font-weight: 600;
        }

        .goal-value {
            color: white;
            font-size: 1.1em;
        }

        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2em;
            }

            .calendar-container {
                grid-template-columns: repeat(4, 1fr);
            }

            .request-card {
                flex-direction: column;
                text-align: center;
            }

            .request-actions {
                width: 100%;
                flex-direction: column;
            }

            .friends-grid {
                grid-template-columns: 1fr;
            }

            .friend-stats {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèãÔ∏è HLA Fitness</h1>
            <p>Stay accountable. Build streaks. Achieve together.</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showSection('profile')">Profile</button>
            <button class="nav-tab" onclick="showSection('friends')">Friends & Streaks</button>
            <button class="nav-tab" onclick="showSection('nutrition')">Nutrition Tracker</button>
            <button class="nav-tab" onclick="showSection('hydration')">Hydration Tracker</button>
            <button class="nav-tab" onclick="showSection('sports')">Sports History</button>
            <button class="nav-tab" onclick="showSection('wellness')">Wellness Goals</button>
        </div>

        <!-- Profile Section -->
        <div id="profile" class="content-section active">
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar" ondragover="handleDragOver(event)" ondrop="handleDrop(event)" ondragleave="handleDragLeave(event)" onclick="document.getElementById('photoInput').click()">
                    <span id="avatarText">üë§</span>
                    <div class="upload-overlay">Drop photo here or click to upload</div>
                    <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="handleFileSelect(event)">
                </div>
                <h2 id="profileName">Your Profile</h2>
                <button class="btn edit-profile-btn" id="editProfileBtn" onclick="toggleEditProfile()">Edit Profile</button>
            </div>

            <div class="card" id="profileDisplay">
                <h2>Personal Information</h2>
                <div class="profile-display">
                    <div class="profile-field">
                        <span class="profile-field-label">Full Name:</span>
                        <span class="profile-field-value" id="displayName">Not set</span>
                    </div>
                    <div class="profile-field">
                        <span class="profile-field-label">Age:</span>
                        <span class="profile-field-value" id="displayAge">Not set</span>
                    </div>
                    <div class="profile-field">
                        <span class="profile-field-label">Gender:</span>
                        <span class="profile-field-value" id="displayGender">Not set</span>
                    </div>
                    <div class="profile-field">
                        <span class="profile-field-label">Weight:</span>
                        <span class="profile-field-value" id="displayWeight">Not set</span>
                    </div>
                    <div class="profile-field">
                        <span class="profile-field-label">Height:</span>
                        <span class="profile-field-value" id="displayHeight">Not set</span>
                    </div>
                </div>
            </div>

            <div class="card hidden" id="profileEdit">
                <h2>Edit Personal Information</h2>
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="userName" placeholder="Enter your name">
                </div>
                <div class="two-column">
                    <div class="form-group">
                        <label>Age</label>
                        <input type="number" id="userAge" placeholder="25">
                    </div>
                    <div class="form-group">
                        <label>Gender</label>
                        <select id="userGender">
                            <option value="">Select</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                <div class="two-column">
                    <div class="form-group">
                        <label>Weight (kg)</label>
                        <input type="number" id="userWeight" placeholder="70">
                    </div>
                    <div class="form-group">
                        <label>Height (cm)</label>
                        <input type="number" id="userHeight" placeholder="175">
                    </div>
                </div>
                <button class="btn" onclick="saveProfile()">Save Profile</button>
                <button class="btn btn-secondary" onclick="cancelEditProfile()">Cancel</button>
            </div>

            <div class="card">
                <h2>Your Fitness Stats</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="currentStreak">0</h3>
                        <p>Day Streak</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalWorkouts">0</h3>
                        <p>Total Workouts</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="activeFriends">0</h3>
                        <p>Active Friends</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Sports Background</h2>
                <div id="profileSportsPreview">
                    <p style="color: #888;">No sports history added yet. Visit the Sports History tab to add your experience.</p>
                </div>
            </div>
        </div>

        <!-- Friends & Streaks Section -->
        <div id="friends" class="content-section">
            <div class="card">
                <div class="section-header">
                    <h2 class="section-title">Add New Friend</h2>
                </div>
                <form class="friend-request-form">
                    <div class="form-group">
                        <label for="friend-input" class="form-label">Search Registered Users</label>
                        <input 
                            type="text" 
                            id="friend-input" 
                            class="form-input" 
                            placeholder="Enter username of registered user"
                        >
                    </div>
                    <button type="button" class="btn" onclick="sendFriendRequest()">
                        <span class="btn-icon">‚ûï</span>
                        Send Friend Request
                    </button>
                    <div class="confirmation-message" id="confirmation-message"></div>
                </form>
            </div>

            <div class="card">
                <div class="section-header">
                    <h2 class="section-title">Incoming Requests</h2>
                    <span class="badge" id="incomingBadge">0</span>
                </div>
                <div class="requests-container" id="incomingRequests">
                    <div class="empty-state">
                        <div class="empty-icon">üì≠</div>
                        <p class="empty-text">No pending friend requests</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="section-header">
                    <h2 class="section-title">Sent Requests</h2>
                    <span class="badge" id="sentBadge">0</span>
                </div>
                <div class="requests-container" id="sentRequests">
                    <div class="empty-state">
                        <div class="empty-icon">üì§</div>
                        <p class="empty-text">No pending sent requests</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="section-header">
                    <h2 class="section-title">Your Training Partners</h2>
                    <span class="badge" id="friendsBadge">0</span>
                </div>
                <div class="friends-grid" id="friendsList">
                    <div class="empty-state">
                        <div class="empty-icon">üë•</div>
                        <p class="empty-text">No friends yet. Send some requests to get started!</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Create Training Streak</h2>
                <div class="form-group">
                    <label>Select Friend</label>
                    <select id="streakFriend">
                        <option value="">Choose a friend</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Training Goal</label>
                    <input type="text" id="trainingGoal" placeholder="e.g., Gym 3x per week">
                </div>
                <button class="btn" onclick="createStreak()">Create Streak Challenge</button>
            </div>
        </div>

        <!-- Nutrition Tracker Section -->
        <div id="nutrition" class="content-section">
            <div class="card">
                <h2>üçé AI Nutrition Tracker</h2>
                
                <div class="form-group">
                    <label>What did you eat?</label>
                    <input 
                        type="text" 
                        id="foodPrompt" 
                        class="form-input" 
                        placeholder="e.g., 2 slices of pizza, chicken salad, protein shake"
                    >
                </div>

                <div class="ai-analyzing" id="aiAnalyzing">
                    <div class="spinner"></div>
                    <span>AI is analyzing your food...</span>
                </div>

                <button class="btn" onclick="logFood()">
                    <span class="btn-icon">ü§ñ</span>
                    Analyze & Log Food
                </button>

                <div class="recommendation-box">
                    <h3>üéØ Your AI Nutrition Recommendation</h3>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 8px; color: #cccccc; font-weight: 600;">Your Fitness Goal:</label>
                        <select id="fitnessGoalSelect" class="form-input" style="width: auto; min-width: 200px;" onchange="updateNutritionRecommendation()">
                            <option value="maintain">Maintain Weight</option>
                            <option value="weight-loss">Weight Loss</option>
                            <option value="muscle-gain">Muscle Gain</option>
                        </select>
                    </div>
                    <p id="nutritionRecommendation">Based on your recent workouts and activity level, we recommend <strong>2,200 calories</strong> per day to support your fitness goals.</p>
                </div>
            </div>

            <!-- Calorie Summary -->
            <div class="card">
                <h2>üìä Calorie Summary</h2>
                <div class="calorie-summary">
                    <div class="calorie-card">
                        <h3 id="todayCalories">0</h3>
                        <p>Today</p>
                        <p style="font-size: 0.8em; margin-top: 5px;">Goal: <span id="dailyCalorieGoalDisplay">2200</span></p>
                    </div>
                    <div class="calorie-card">
                        <h3 id="weeklyCalories">0</h3>
                        <p>This Week</p>
                        <p style="font-size: 0.8em; margin-top: 5px;">Goal: <span id="weeklyCalorieGoalDisplay">15400</span></p>
                    </div>
                    <div class="calorie-card">
                        <h3 id="monthlyCalories">0</h3>
                        <p>This Month</p>
                        <p style="font-size: 0.8em; margin-top: 5px;">Goal: <span id="monthlyCalorieGoalDisplay">66000</span></p>
                    </div>
                </div>

                <div class="progress-bar-container">
                    <div class="progress-bar" id="calorieProgress">0%</div>
                </div>
            </div>

            <!-- Set Nutrition Goals -->
            <div class="card">
                <h2>Set Your Nutrition Goals</h2>
                <div class="goal-edit-section">
                    <div class="form-group">
                        <label>Daily Calorie Goal</label>
                        <input type="number" id="customDailyCalories" placeholder="2200" value="2200">
                    </div>
                    <div class="form-group">
                        <label>Weekly Calorie Goal</label>
                        <input type="number" id="customWeeklyCalories" placeholder="15400" value="15400">
                    </div>
                    <div class="form-group">
                        <label>Monthly Calorie Goal</label>
                        <input type="number" id="customMonthlyCalories" placeholder="66000" value="66000">
                    </div>
                    <button class="btn" onclick="saveNutritionGoals()">Save Nutrition Goals</button>
                </div>

                <div class="nutrition-goals-display">
                    <h3 style="color: #B8A4D4; margin-bottom: 15px;">Current Goals</h3>
                    <div class="goal-display">
                        <span class="goal-label">Daily:</span>
                        <span class="goal-value" id="displayDailyCalories">2200 calories</span>
                    </div>
                    <div class="goal-display">
                        <span class="goal-label">Weekly:</span>
                        <span class="goal-value" id="displayWeeklyCalories">15400 calories</span>
                    </div>
                    <div class="goal-display">
                        <span class="goal-label">Monthly:</span>
                        <span class="goal-value" id="displayMonthlyCalories">66000 calories</span>
                    </div>
                </div>
            </div>

            <!-- Today's Food Log -->
            <div class="card">
                <h2>Today's Food Log</h2>
                <div class="food-log-container" id="todayFoodLog">
                    <p style="color: #888; text-align: center;">No food logged yet today. Start by entering what you ate above!</p>
                </div>
            </div>

            <!-- Macro Breakdown -->
            <div class="card">
                <h2>Macro Breakdown (Today)</h2>
                <div class="macro-breakdown">
                    <div class="macro-item">
                        <h4>Protein</h4>
                        <div class="macro-value" id="proteinTotal">0g</div>
                    </div>
                    <div class="macro-item">
                        <h4>Carbs</h4>
                        <div class="macro-value" id="carbsTotal">0g</div>
                    </div>
                    <div class="macro-item">
                        <h4>Fats</h4>
                        <div class="macro-value" id="fatsTotal">0g</div>
                    </div>
                </div>
            </div>

            <!-- Weekly Calendar -->
            <div class="card">
                <div class="calendar-header">
                    <h2>Weekly Nutrition - This Week</h2>
                </div>
                <div class="calendar-container" id="weeklyNutritionCalendar"></div>
            </div>

            <!-- Monthly Calendar -->
            <div class="card">
                <div class="calendar-header">
                    <h2>Monthly Nutrition</h2>
                    <div class="calendar-nav">
                        <select class="month-selector" id="nutritionMonthSelector" onchange="updateNutritionMonthlyCalendar()">
                            <option value="0">January</option>
                            <option value="1">February</option>
                            <option value="2">March</option>
                            <option value="3">April</option>
                            <option value="4">May</option>
                            <option value="5">June</option>
                            <option value="6">July</option>
                            <option value="7">August</option>
                            <option value="8">September</option>
                            <option value="9">October</option>
                            <option value="10">November</option>
                            <option value="11">December</option>
                        </select>
                    </div>
                </div>
                <div class="calendar-container" id="monthlyNutritionCalendar"></div>
            </div>
        </div>

        <!-- Hydration Tracker Section -->
        <div id="hydration" class="content-section">
            <div class="card">
                <h2>üíß Daily Hydration Tracker</h2>
                
                <div class="form-group">
                    <label>What did you drink?</label>
                    <select id="drinkType">
                        <option value="water">Water</option>
                        <option value="juice">Juice</option>
                        <option value="tea">Tea</option>
                        <option value="coffee">Coffee</option>
                        <option value="sports-drink">Sports Drink</option>
                    </select>
                </div>

                <div class="water-bottle-container">
                    <h3>Adjust Your Intake</h3>
                    <div class="water-bottle">
                        <div class="water-level" id="waterLevel"></div>
                    </div>
                    <input type="range" min="0" max="100" value="0" class="water-slider" id="waterSlider" oninput="updateWaterLevel()">
                    <div class="water-stats">
                        <h3 id="waterAmount">0 ml</h3>
                        <p>of <span id="dailyWaterGoal">2000</span> ml daily goal</p>
                    </div>
                </div>

                <div class="progress-bar-container">
                    <div class="progress-bar" id="waterProgress">0%</div>
                </div>

                <button class="btn" onclick="logWater()">Log Water Intake</button>

                <div class="recommendation-box">
                    <h3>üí° AI Recommendation</h3>
                    <p id="waterRecommendation">Based on your profile and activity level, we recommend <strong>2.5 liters</strong> per day.</p>
                </div>
            </div>

            <!-- Water Goals Settings -->
            <div class="card">
                <h2>Set Your Water Goals</h2>
                <div class="goal-edit-section">
                    <div class="form-group">
                        <label>Daily Goal (ml)</label>
                        <input type="number" id="customDailyWaterGoal" placeholder="2000" value="2000">
                    </div>
                    <div class="form-group">
                        <label>Weekly Goal (liters)</label>
                        <input type="number" id="customWeeklyWaterGoal" placeholder="14" value="14">
                    </div>
                    <div class="form-group">
                        <label>Monthly Goal (liters)</label>
                        <input type="number" id="customMonthlyWaterGoal" placeholder="60" value="60">
                    </div>
                    <button class="btn" onclick="saveWaterGoals()">Save Water Goals</button>
                </div>
            </div>

            <!-- Daily Calendar -->
            <div class="card">
                <div class="calendar-header">
                    <h2>Daily Hydration - This Week</h2>
                </div>
                <div class="calendar-container" id="dailyWaterCalendar"></div>
            </div>

            <!-- Monthly Calendar -->
            <div class="card">
                <div class="calendar-header">
                    <h2>Monthly Hydration</h2>
                    <div class="calendar-nav">
                        <select class="month-selector" id="monthSelector" onchange="updateMonthlyCalendar()">
                            <option value="0">January</option>
                            <option value="1">February</option>
                            <option value="2">March</option>
                            <option value="3">April</option>
                            <option value="4">May</option>
                            <option value="5">June</option>
                            <option value="6">July</option>
                            <option value="7">August</option>
                            <option value="8">September</option>
                            <option value="9">October</option>
                            <option value="10">November</option>
                            <option value="11">December</option>
                        </select>
                    </div>
                </div>
                <div class="calendar-container" id="monthlyWaterCalendar"></div>
            </div>
        </div>

        <!-- Sports History Section -->
        <div id="sports" class="content-section">
            <div class="card">
                <h2>Add Sports Experience</h2>
                <div class="form-group">
                    <label>Sport</label>
                    <input type="text" id="sportName" placeholder="e.g., Basketball, Soccer, Swimming">
                </div>
                <div class="form-group">
                    <label>Team/Club</label>
                    <input type="text" id="teamName" placeholder="e.g., City United FC">
                </div>
                <div class="two-column">
                    <div class="form-group">
                        <label>Start Year</label>
                        <input type="number" id="sportStart" placeholder="2018">
                    </div>
                    <div class="form-group">
                        <label>End Year</label>
                        <input type="number" id="sportEnd" placeholder="2022">
                    </div>
                </div>
                <div class="form-group">
                    <label>Position/Role</label>
                    <input type="text" id="sportPosition" placeholder="e.g., Point Guard, Midfielder">
                </div>
                <div class="form-group">
                    <label>Achievements</label>
                    <textarea id="sportAchievements" rows="3" placeholder="Any notable achievements or highlights..."></textarea>
                </div>
                <button class="btn" onclick="addSport()">Add to History</button>
            </div>

            <div class="card">
                <h2>Your Sports Journey</h2>
                <div class="sports-history" id="sportsHistory">
                    <p style="color: #888;">No sports history added yet.</p>
                </div>
            </div>
        </div>

        <!-- Wellness Goals Section -->
        <div id="wellness" class="content-section">
            <div class="card">
                <h2>Wellness & Training Recommendations</h2>
                <div class="recommendation-box">
                    <h3>üéØ AI Recommendation</h3>
                    <div id="wellnessRecommendations">
                        <p><strong>Daily Exercise:</strong> 30-45 minutes of moderate activity</p>
                        <p><strong>Weekly Goal:</strong> 150-200 minutes of exercise</p>
                        <p><strong>Monthly Target:</strong> 10-12 hours of structured training</p>
                        <p style="margin-top: 15px; padding-top: 15px; border-top: 2px solid #F4A116;">
                            üí° <em>These recommendations are based on your age, weight, and height. Adjust based on your fitness level.</em>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Custom Goals -->
            <div class="card">
                <h2>Set Your Personal Goals</h2>
                <div class="goal-edit-section">
                    <div class="form-group">
                        <label>Daily Exercise Goal (minutes)</label>
                        <input type="number" id="customDailyGoal" placeholder="30" value="30">
                    </div>
                    <div class="form-group">
                        <label>Weekly Exercise Goal (minutes)</label>
                        <input type="number" id="customWeeklyGoal" placeholder="150" value="150">
                    </div>
                    <div class="form-group">
                        <label>Monthly Exercise Goal (hours)</label>
                        <input type="number" id="customMonthlyGoal" placeholder="10" value="10">
                    </div>
                    <button class="btn" onclick="saveWellnessGoals()">Save Goals</button>
                </div>

                <div class="goal-edit-section" style="margin-top: 20px;">
                    <h3 style="color: #F4A116; margin-bottom: 15px;">Your Current Goals</h3>
                    <div class="goal-display">
                        <span class="goal-label">Daily:</span>
                        <span class="goal-value" id="displayDailyGoal">30 minutes</span>
                    </div>
                    <div class="goal-display">
                        <span class="goal-label">Weekly:</span>
                        <span class="goal-value" id="displayWeeklyGoal">150 minutes</span>
                    </div>
                    <div class="goal-display">
                        <span class="goal-label">Monthly:</span>
                        <span class="goal-value" id="displayMonthlyGoal">10 hours</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Log Today's Workout</h2>
                <div class="form-group">
                    <label>Activity Type</label>
                    <select id="workoutType">
                        <option>Gym/Weights</option>
                        <option>Running</option>
                        <option>Cycling</option>
                        <option>Swimming</option>
                        <option>Sports Practice</option>
                        <option>Yoga/Stretching</option>
                        <option>Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Duration (minutes)</label>
                    <input type="number" id="workoutDuration" placeholder="45">
                </div>
                <div class="form-group">
                    <label>Intensity</label>
                    <select id="workoutIntensity">
                        <option>Light</option>
                        <option>Moderate</option>
                        <option>Intense</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="workoutNotes" rows="3" placeholder="How did you feel? Any goals achieved?"></textarea>
                </div>
                <button class="btn" onclick="logWorkout()">Log Workout</button>
            </div>

            <!-- Workout Calendar -->
            <div class="card">
                <div class="calendar-header">
                    <h2>This Month's Workouts</h2>
                    <div class="calendar-nav">
                        <select class="month-selector" id="workoutMonthSelector" onchange="updateWorkoutCalendar()">
                            <option value="0">January</option>
                            <option value="1">February</option>
                            <option value="2">March</option>
                            <option value="3">April</option>
                            <option value="4">May</option>
                            <option value="5">June</option>
                            <option value="6">July</option>
                            <option value="7">August</option>
                            <option value="8">September</option>
                            <option value="9">October</option>
                            <option value="10">November</option>
                            <option value="11">December</option>
                        </select>
                    </div>
                </div>
                <div class="calendar-container" id="workoutCalendar"></div>
            </div>

            <div class="card">
                <h2>This Week's Progress</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="weeklyDays">0/7</h3>
                        <p>Days Active</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="weeklyMinutes">0</h3>
                        <p>Minutes Trained</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="weeklyGoal">0%</h3>
                        <p>Weekly Goal</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simulated database of registered users
        const registeredUsers = [
            { username: 'sarah_fitness', name: 'Sarah Johnson', streak: 15, workouts: 45 },
            { username: 'mike_gym', name: 'Mike Chen', streak: 8, workouts: 32 },
            { username: 'alex_athlete', name: 'Alex Liu', streak: 22, workouts: 67 },
            { username: 'katie_run', name: 'Katie Wilson', streak: 28, workouts: 89 },
            { username: 'david_lift', name: 'David Park', streak: 15, workouts: 52 }
        ];

        // Data storage
        let currentUser = { username: 'you', isLoggedIn: true };
        let profileData = { name: '', age: '', gender: '', weight: '', height: '' };
        let sportsHistory = [];
        let waterIntake = {};
        let workoutLog = {};
        let weeklyWorkoutMinutes = 0;
        let totalWorkouts = 0;
        let currentStreak = 0;
        let friends = [];
        let incomingRequests = [];
        let sentRequests = [];
        
        // Nutrition tracking
        let foodLog = {};
        let dailyMacros = { protein: 0, carbs: 0, fats: 0 };
        let nutritionGoals = { daily: 2200, weekly: 15400, monthly: 66000 };
        
        // Custom goals
        let customWaterGoals = { daily: 2000, weekly: 14, monthly: 60 };
        let customWellnessGoals = { daily: 30, weekly: 150, monthly: 10 };

        // AI Food Database (simplified simulation)
        const foodDatabase = {
            'pizza': { calories: 285, protein: 12, carbs: 36, fats: 10, serving: 'slice' },
            'burger': { calories: 540, protein: 25, carbs: 45, fats: 25, serving: 'burger' },
            'salad': { calories: 150, protein: 8, carbs: 15, fats: 8, serving: 'bowl' },
            'chicken': { calories: 165, protein: 31, carbs: 0, fats: 3.6, serving: '100g' },
            'rice': { calories: 130, protein: 2.7, carbs: 28, fats: 0.3, serving: 'cup' },
            'pasta': { calories: 220, protein: 8, carbs: 43, fats: 1.3, serving: 'cup' },
            'eggs': { calories: 155, protein: 13, carbs: 1.1, fats: 11, serving: '2 eggs' },
            'banana': { calories: 105, protein: 1.3, carbs: 27, fats: 0.4, serving: 'banana' },
            'apple': { calories: 95, protein: 0.5, carbs: 25, fats: 0.3, serving: 'apple' },
            'sandwich': { calories: 350, protein: 15, carbs: 40, fats: 12, serving: 'sandwich' },
            'protein shake': { calories: 160, protein: 30, carbs: 5, fats: 2, serving: 'shake' },
            'yogurt': { calories: 150, protein: 12, carbs: 17, fats: 4, serving: 'cup' },
            'oatmeal': { calories: 150, protein: 5, carbs: 27, fats: 3, serving: 'cup' },
            'steak': { calories: 271, protein: 25, carbs: 0, fats: 19, serving: '100g' },
            'fish': { calories: 206, protein: 22, carbs: 0, fats: 12, serving: '100g' },
            'broccoli': { calories: 55, protein: 3.7, carbs: 11, fats: 0.6, serving: 'cup' },
            'sweet potato': { calories: 103, protein: 2.3, carbs: 24, fats: 0.2, serving: 'potato' },
            'avocado': { calories: 240, protein: 3, carbs: 13, fats: 22, serving: 'avocado' }
        };

        window.onload = function() {
            initializeDailyWaterCalendar();
            updateMonthlyCalendar();
            updateWorkoutCalendar();
            updateFriendsDisplay();
            initializeWeeklyNutritionCalendar();
            updateNutritionMonthlyCalendar();
            
            const currentMonth = new Date().getMonth();
            document.getElementById('monthSelector').value = currentMonth;
            document.getElementById('workoutMonthSelector').value = currentMonth;
            document.getElementById('nutritionMonthSelector').value = currentMonth;
        };

        function showSection(sectionId) {
            const sections = document.querySelectorAll('.content-section');
            const tabs = document.querySelectorAll('.nav-tab');
            
            sections.forEach(section => section.classList.remove('active'));
            tabs.forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        // Profile Management
        function toggleEditProfile() {
            document.getElementById('profileDisplay').classList.add('hidden');
            document.getElementById('profileEdit').classList.remove('hidden');
            document.getElementById('editProfileBtn').style.display = 'none';
            
            document.getElementById('userName').value = profileData.name || '';
            document.getElementById('userAge').value = profileData.age || '';
            document.getElementById('userGender').value = profileData.gender || '';
            document.getElementById('userWeight').value = profileData.weight || '';
            document.getElementById('userHeight').value = profileData.height || '';
        }

        function cancelEditProfile() {
            document.getElementById('profileDisplay').classList.remove('hidden');
            document.getElementById('profileEdit').classList.add('hidden');
            document.getElementById('editProfileBtn').style.display = 'block';
        }

        function saveProfile() {
            const name = document.getElementById('userName').value;
            const age = document.getElementById('userAge').value;
            const gender = document.getElementById('userGender').value;
            const weight = document.getElementById('userWeight').value;
            const height = document.getElementById('userHeight').value;

            if (name && age && gender && weight && height) {
                profileData = { name, age, gender, weight, height };
                
                document.getElementById('displayName').textContent = name;
                document.getElementById('displayAge').textContent = age + ' years';
                document.getElementById('displayGender').textContent = gender;
                document.getElementById('displayWeight').textContent = weight + ' kg';
                document.getElementById('displayHeight').textContent = height + ' cm';
                document.getElementById('profileName').textContent = name;
                
                const bmi = (weight / ((height/100) ** 2)).toFixed(1);
                let weeklyMinutes = 150;
                
                if (age < 18) {
                    weeklyMinutes = 210;
                } else if (age >= 18 && age <= 64) {
                    weeklyMinutes = 150;
                } else {
                    weeklyMinutes = 150;
                }
                
                const dailyMinutes = Math.round(weeklyMinutes / 7);
                const monthlyHours = Math.round((weeklyMinutes * 4) / 60);
                
                const recommendations = document.getElementById('wellnessRecommendations');
                recommendations.innerHTML = `
                    <p><strong>Daily Exercise:</strong> ${dailyMinutes}-${dailyMinutes + 15} minutes of moderate activity</p>
                    <p><strong>Weekly Goal:</strong> ${weeklyMinutes}-${weeklyMinutes + 50} minutes of exercise</p>
                    <p><strong>Monthly Target:</strong> ${monthlyHours}-${monthlyHours + 2} hours of structured training</p>
                    <p><strong>BMI:</strong> ${bmi}</p>
                    <p style="margin-top: 15px; padding-top: 15px; border-top: 2px solid #B8A4D4;">
                        üí° <em>These are AI recommendations. You can set your own goals in the section below.</em>
                    </p>
                `;
                
                updateWaterRecommendation();
                cancelEditProfile();
                alert('Profile saved successfully!');
            } else {
                alert('Please fill in all fields');
            }
        }

        // Friend System - Only Registered Users
        function sendFriendRequest() {
            const input = document.getElementById('friend-input');
            const message = document.getElementById('confirmation-message');
            const username = input.value.trim();
            
            if (!username) {
                message.className = 'confirmation-message error';
                message.textContent = 'Please enter a username';
                setTimeout(() => message.className = 'confirmation-message', 3000);
                return;
            }

            const user = registeredUsers.find(u => u.username.toLowerCase() === username.toLowerCase());
            
            if (!user) {
                message.className = 'confirmation-message error';
                message.textContent = 'User not found. Only registered users can be added.';
                setTimeout(() => message.className = 'confirmation-message', 3000);
                return;
            }

            if (friends.some(f => f.username === user.username)) {
                message.className = 'confirmation-message error';
                message.textContent = 'Already friends with this user';
                setTimeout(() => message.className = 'confirmation-message', 3000);
                return;
            }

            if (sentRequests.some(r => r.username === user.username)) {
                message.className = 'confirmation-message error';
                message.textContent = 'Friend request already sent';
                setTimeout(() => message.className = 'confirmation-message', 3000);
                return;
            }

            sentRequests.push(user);
            message.className = 'confirmation-message success';
            message.textContent = `Friend request sent to ${user.name}!`;
            input.value = '';
            
            updateFriendsDisplay();
            setTimeout(() => message.className = 'confirmation-message', 3000);
        }

        function updateFriendsDisplay() {
            document.getElementById('friendsBadge').textContent = friends.length;
            document.getElementById('incomingBadge').textContent = incomingRequests.length;
            document.getElementById('sentBadge').textContent = sentRequests.length;
            document.getElementById('activeFriends').textContent = friends.length;

            // Update friends list
            const friendsList = document.getElementById('friendsList');
            if (friends.length === 0) {
                friendsList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üë•</div>
                        <p class="empty-text">No friends yet. Send some requests to get started!</p>
                    </div>
                `;
            } else {
                friendsList.innerHTML = friends.map(friend => `
                    <div class="friend-card">
                        <div class="friend-avatar">
                            <span class="avatar-placeholder large">${friend.name.split(' ').map(n => n[0]).join('')}</span>
                        </div>
                        <div class="friend-info">
                            <h3 class="friend-name">${friend.name}</h3>
                            <p class="friend-username">@${friend.username}</p>
                        </div>
                        <div class="friend-stats">
                            <div class="stat-item">
                                <span class="stat-value">üî• ${friend.streak}</span>
                                <span class="stat-label">Day Streak</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">${friend.workouts}</span>
                                <span class="stat-label">Workouts</span>
                            </div>
                        </div>
                        <div class="friend-actions">
                            <button class="btn btn-message">Message</button>
                            <button class="btn btn-secondary">View Profile</button>
                        </div>
                    </div>
                `).join('');
            }

            // Update sent requests
            const sentRequestsContainer = document.getElementById('sentRequests');
            if (sentRequests.length === 0) {
                sentRequestsContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üì§</div>
                        <p class="empty-text">No pending sent requests</p>
                    </div>
                `;
            } else {
                sentRequestsContainer.innerHTML = sentRequests.map((req, index) => `
                    <div class="request-card outgoing">
                        <div class="request-avatar">
                            <span class="avatar-placeholder">${req.name.split(' ').map(n => n[0]).join('')}</span>
                        </div>
                        <div class="request-info">
                            <h3 class="request-name">${req.name}</h3>
                            <p class="request-meta">@${req.username} ‚Ä¢ Sent recently</p>
                            <p class="request-status pending">Pending</p>
                        </div>
                        <div class="request-actions">
                            <button class="btn btn-cancel" onclick="cancelRequest(${index})">Cancel</button>
                        </div>
                    </div>
                `).join('');
            }

            // Update streak friend selector
            const streakSelector = document.getElementById('streakFriend');
            streakSelector.innerHTML = '<option value="">Choose a friend</option>' +
                friends.map(f => `<option value="${f.username}">${f.name}</option>`).join('');
        }

        function cancelRequest(index) {
            sentRequests.splice(index, 1);
            updateFriendsDisplay();
        }

        function createStreak() {
            const friend = document.getElementById('streakFriend').value;
            const goal = document.getElementById('trainingGoal').value;
            
            if (friend && goal) {
                alert(`Streak challenge created! Goal: ${goal} üî•`);
                document.getElementById('streakFriend').value = '';
                document.getElementById('trainingGoal').value = '';
            } else {
                alert('Please select a friend and enter a training goal');
            }
        }

        // Water Goals
        function saveWaterGoals() {
            const daily = parseInt(document.getElementById('customDailyWaterGoal').value);
            const weekly = parseFloat(document.getElementById('customWeeklyWaterGoal').value);
            const monthly = parseFloat(document.getElementById('customMonthlyWaterGoal').value);
            
            if (daily && weekly && monthly) {
                customWaterGoals = { daily, weekly: weekly * 1000, monthly: monthly * 1000 };
                document.getElementById('dailyWaterGoal').textContent = daily;
                updateWaterProgress();
                alert('Water goals saved successfully!');
            }
        }

        function updateWaterLevel() {
            const slider = document.getElementById('waterSlider');
            const waterLevel = document.getElementById('waterLevel');
            const waterAmount = document.getElementById('waterAmount');
            const goal = parseInt(document.getElementById('dailyWaterGoal').textContent);
            
            const percentage = slider.value;
            const milliliters = Math.round((percentage / 100) * goal);
            
            waterLevel.style.height = percentage + '%';
            waterAmount.textContent = milliliters + ' ml';
        }

        function updateWaterProgress() {
            const today = new Date().toDateString();
            const consumed = waterIntake[today] || 0;
            const goal = customWaterGoals.daily;
            const percentage = Math.min(Math.round((consumed / goal) * 100), 100);
            
            const progressBar = document.getElementById('waterProgress');
            progressBar.style.width = percentage + '%';
            progressBar.textContent = percentage + '%';
        }

        function updateWaterRecommendation() {
            const weight = parseFloat(profileData.weight) || 70;
            let baseWater = weight * 33;
            const workoutBonus = Math.round(weeklyWorkoutMinutes / 30) * 250;
            const totalWater = baseWater + workoutBonus;
            
            const recommendation = document.getElementById('waterRecommendation');
            recommendation.innerHTML = `Based on your profile (${profileData.weight || 70}kg) and activity level (${weeklyWorkoutMinutes} min/week), we recommend <strong>${(totalWater/1000).toFixed(1)} liters</strong> per day. You can adjust your goals above.`;
        }

        function logWater() {
            const drinkType = document.getElementById('drinkType').value;
            const amount = document.getElementById('waterAmount').textContent;
            const today = new Date().toDateString();
            
            if (!waterIntake[today]) {
                waterIntake[today] = 0;
            }
            
            const ml = parseInt(amount.split(' ')[0]);
            waterIntake[today] += ml;
            
            alert(`Logged ${amount} of ${drinkType}! Stay hydrated! üíß`);
            
            document.getElementById('waterSlider').value = 0;
            updateWaterLevel();
            updateWaterProgress();
            
            initializeDailyWaterCalendar();
            updateMonthlyCalendar();
        }

        function initializeDailyWaterCalendar() {
            const calendar = document.getElementById('dailyWaterCalendar');
            calendar.innerHTML = '';
            
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const today = new Date();
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toDateString();
                
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                if (i === 0) dayDiv.classList.add('today');
                if (waterIntake[dateStr]) dayDiv.classList.add('has-data');
                
                dayDiv.innerHTML = `
                    <div class="calendar-day-label">${days[date.getDay()]}</div>
                    <div class="calendar-day-number">${date.getDate()}</div>
                    <div class="calendar-day-value">${waterIntake[dateStr] ? waterIntake[dateStr] + 'ml' : '-'}</div>
                `;
                
                calendar.appendChild(dayDiv);
            }
        }

        function updateMonthlyCalendar() {
            const calendar = document.getElementById('monthlyWaterCalendar');
            const monthSelector = document.getElementById('monthSelector');
            const selectedMonth = parseInt(monthSelector.value);
            const year = new Date().getFullYear();
            
            calendar.innerHTML = '';
            
            const daysInMonth = new Date(year, selectedMonth + 1, 0).getDate();
            const firstDay = new Date(year, selectedMonth, 1).getDay();
            
            for (let i = 0; i < firstDay; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day';
                emptyDiv.style.opacity = '0.3';
                calendar.appendChild(emptyDiv);
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, selectedMonth, day);
                const dateStr = date.toDateString();
                
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                
                const today = new Date();
                if (date.toDateString() === today.toDateString()) {
                    dayDiv.classList.add('today');
                }
                if (waterIntake[dateStr]) {
                    dayDiv.classList.add('has-data');
                }
                
                dayDiv.innerHTML = `
                    <div class="calendar-day-number">${day}</div>
                    <div class="calendar-day-value">${waterIntake[dateStr] ? waterIntake[dateStr] + 'ml' : '-'}</div>
                `;
                
                calendar.appendChild(dayDiv);
            }
        }

        // Wellness Goals
        function saveWellnessGoals() {
            const daily = parseInt(document.getElementById('customDailyGoal').value);
            const weekly = parseInt(document.getElementById('customWeeklyGoal').value);
            const monthly = parseInt(document.getElementById('customMonthlyGoal').value);
            
            if (daily && weekly && monthly) {
                customWellnessGoals = { daily, weekly, monthly };
                document.getElementById('displayDailyGoal').textContent = daily + ' minutes';
                document.getElementById('displayWeeklyGoal').textContent = weekly + ' minutes';
                document.getElementById('displayMonthlyGoal').textContent = monthly + ' hours';
                alert('Wellness goals saved successfully!');
            }
        }

        // Sports History
        function addSport() {
            const sport = document.getElementById('sportName').value;
            const team = document.getElementById('teamName').value;
            const start = document.getElementById('sportStart').value;
            const end = document.getElementById('sportEnd').value;
            const position = document.getElementById('sportPosition').value;
            const achievements = document.getElementById('sportAchievements').value;
            
            if (sport && team) {
                const sportEntry = {
                    id: Date.now(),
                    sport, team, start, end, position, achievements
                };
                
                sportsHistory.push(sportEntry);
                renderSportsHistory();
                updateProfileSportsPreview();
                
                document.getElementById('sportName').value = '';
                document.getElementById('teamName').value = '';
                document.getElementById('sportStart').value = '';
                document.getElementById('sportEnd').value = '';
                document.getElementById('sportPosition').value = '';
                document.getElementById('sportAchievements').value = '';
                
                alert('Sport added to your history!');
            } else {
                alert('Please fill in at least Sport and Team/Club');
            }
        }

        function renderSportsHistory() {
            const container = document.getElementById('sportsHistory');
            
            if (sportsHistory.length === 0) {
                container.innerHTML = '<p style="color: #888;">No sports history added yet.</p>';
                return;
            }
            
            container.innerHTML = '';
            
            sportsHistory.forEach(sport => {
                const sportDiv = document.createElement('div');
                sportDiv.className = 'sport-entry';
                sportDiv.innerHTML = `
                    <div class="sport-entry-actions">
                        <button class="btn btn-small btn-secondary" onclick="editSport(${sport.id})">Edit</button>
                        <button class="btn btn-small btn-secondary" onclick="deleteSport(${sport.id})">Delete</button>
                    </div>
                    <h4>üèÜ ${sport.sport} - ${sport.team}</h4>
                    <p><strong>${sport.start || '?'}-${sport.end || 'Present'}</strong> ${sport.position ? '| ' + sport.position : ''}</p>
                    ${sport.achievements ? '<p>' + sport.achievements + '</p>' : ''}
                `;
                container.appendChild(sportDiv);
            });
        }

        function deleteSport(id) {
            if (confirm('Are you sure you want to delete this entry?')) {
                sportsHistory = sportsHistory.filter(sport => sport.id !== id);
                renderSportsHistory();
                updateProfileSportsPreview();
            }
        }

        function editSport(id) {
            const sport = sportsHistory.find(s => s.id === id);
            if (sport) {
                document.getElementById('sportName').value = sport.sport;
                document.getElementById('teamName').value = sport.team;
                document.getElementById('sportStart').value = sport.start;
                document.getElementById('sportEnd').value = sport.end;
                document.getElementById('sportPosition').value = sport.position;
                document.getElementById('sportAchievements').value = sport.achievements;
                
                deleteSport(id);
                window.scrollTo(0, 0);
            }
        }

        function updateProfileSportsPreview() {
            const preview = document.getElementById('profileSportsPreview');
            
            if (sportsHistory.length === 0) {
                preview.innerHTML = '<p style="color: #888;">No sports history added yet. Visit the Sports History tab to add your experience.</p>';
                return;
            }
            
            let html = '';
            sportsHistory.slice(0, 3).forEach(sport => {
                html += `
                    <div class="sport-entry" style="margin-bottom: 10px;">
                        <h4>üèÜ ${sport.sport} - ${sport.team}</h4>
                        <p style="color: #888;"><strong>${sport.start || '?'}-${sport.end || 'Present'}</strong> ${sport.position ? '| ' + sport.position : ''}</p>
                    </div>
                `;
            });
            
            if (sportsHistory.length > 3) {
                html += `<p style="color: #888; margin-top: 10px;">+ ${sportsHistory.length - 3} more...</p>`;
            }
            
            preview.innerHTML = html;
        }

        // Workout tracking
        function logWorkout() {
            const type = document.getElementById('workoutType').value;
            const duration = parseInt(document.getElementById('workoutDuration').value);
            const intensity = document.getElementById('workoutIntensity').value;
            const notes = document.getElementById('workoutNotes').value;
            
            if (!duration || duration <= 0) {
                alert('Please enter workout duration');
                return;
            }
            
            const today = new Date().toDateString();
            
            if (!workoutLog[today]) {
                workoutLog[today] = [];
            }
            
            workoutLog[today].push({
                type, duration, intensity, notes,
                timestamp: new Date().toLocaleTimeString()
            });
            
            totalWorkouts++;
            weeklyWorkoutMinutes += duration;
            currentStreak++;
            
            document.getElementById('totalWorkouts').textContent = totalWorkouts;
            document.getElementById('currentStreak').textContent = currentStreak;
            document.getElementById('weeklyMinutes').textContent = weeklyWorkoutMinutes;
            
            const activeDays = Object.keys(workoutLog).length;
            document.getElementById('weeklyDays').textContent = `${Math.min(activeDays, 7)}/7`;
            
            const weeklyGoalValue = customWellnessGoals.weekly;
            const goalPercentage = Math.min(Math.round((weeklyWorkoutMinutes / weeklyGoalValue) * 100), 100);
            document.getElementById('weeklyGoal').textContent = goalPercentage + '%';
            
            document.getElementById('workoutDuration').value = '';
            document.getElementById('workoutNotes').value = '';
            
            updateWaterRecommendation();
            updateNutritionRecommendation();
            updateWorkoutCalendar();
            
            alert('Workout logged! Keep up the great work! üí™');
        }

        // Nutrition Tracking Functions
        function logFood() {
            const foodPrompt = document.getElementById('foodPrompt').value.trim().toLowerCase();
            
            if (!foodPrompt) {
                alert('Please enter what you ate');
                return;
            }

            // Show AI analyzing animation
            document.getElementById('aiAnalyzing').classList.add('active');
            
            // Simulate AI processing
            setTimeout(() => {
                const result = analyzeFood(foodPrompt);
                
                if (result) {
                    const today = new Date().toDateString();
                    
                    if (!foodLog[today]) {
                        foodLog[today] = [];
                    }
                    
                    const foodEntry = {
                        description: foodPrompt,
                        calories: result.calories,
                        protein: result.protein,
                        carbs: result.carbs,
                        fats: result.fats,
                        time: new Date().toLocaleTimeString()
                    };
                    
                    foodLog[today].push(foodEntry);
                    
                    // Update totals
                    dailyMacros.protein += result.protein;
                    dailyMacros.carbs += result.carbs;
                    dailyMacros.fats += result.fats;
                    
                    updateNutritionDisplay();
                    updateNutritionRecommendation();
                    
                    document.getElementById('foodPrompt').value = '';
                    alert(`‚úÖ Logged: ${foodPrompt}\nüìä ${result.calories} calories\nü•© ${result.protein}g protein | üçû ${result.carbs}g carbs | ü•ë ${result.fats}g fats`);
                } else {
                    alert('Food not recognized. Try being more specific (e.g., "2 slices of pizza" instead of just "food")');
                }
                
                document.getElementById('aiAnalyzing').classList.remove('active');
            }, 1500);
        }

        function analyzeFood(prompt) {
            // Extract quantity
            let quantity = 1;
            const quantityMatch = prompt.match(/(\d+)\s*/);
            if (quantityMatch) {
                quantity = parseInt(quantityMatch[1]);
            }
            
            // Search for food in database
            for (const [food, nutrition] of Object.entries(foodDatabase)) {
                if (prompt.includes(food)) {
                    return {
                        calories: Math.round(nutrition.calories * quantity),
                        protein: Math.round(nutrition.protein * quantity * 10) / 10,
                        carbs: Math.round(nutrition.carbs * quantity * 10) / 10,
                        fats: Math.round(nutrition.fats * quantity * 10) / 10
                    };
                }
            }
            
            return null;
        }

        function updateNutritionDisplay() {
            const today = new Date().toDateString();
            const todayFoods = foodLog[today] || [];
            
            // Calculate totals
            let todayCalories = 0;
            let weeklyCalories = 0;
            let monthlyCalories = 0;
            
            // Today's calories
            todayFoods.forEach(food => {
                todayCalories += food.calories;
            });
            
            // Weekly calories (last 7 days)
            for (let i = 0; i < 7; i++) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toDateString();
                if (foodLog[dateStr]) {
                    foodLog[dateStr].forEach(food => {
                        weeklyCalories += food.calories;
                    });
                }
            }
            
            // Monthly calories (last 30 days)
            for (let i = 0; i < 30; i++) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toDateString();
                if (foodLog[dateStr]) {
                    foodLog[dateStr].forEach(food => {
                        monthlyCalories += food.calories;
                    });
                }
            }
            
            // Update displays
            document.getElementById('todayCalories').textContent = todayCalories;
            document.getElementById('weeklyCalories').textContent = weeklyCalories;
            document.getElementById('monthlyCalories').textContent = monthlyCalories;
            
            // Update progress bar
            const dailyGoal = nutritionGoals.daily;
            const percentage = Math.min(Math.round((todayCalories / dailyGoal) * 100), 100);
            document.getElementById('calorieProgress').style.width = percentage + '%';
            document.getElementById('calorieProgress').textContent = percentage + '%';
            
            // Update macros
            document.getElementById('proteinTotal').textContent = dailyMacros.protein + 'g';
            document.getElementById('carbsTotal').textContent = dailyMacros.carbs + 'g';
            document.getElementById('fatsTotal').textContent = dailyMacros.fats + 'g';
            
            // Update food log display
            const foodLogContainer = document.getElementById('todayFoodLog');
            if (todayFoods.length === 0) {
                foodLogContainer.innerHTML = '<p style="color: #888; text-align: center;">No food logged yet today. Start by entering what you ate above!</p>';
            } else {
                foodLogContainer.innerHTML = todayFoods.map(food => `
                    <div class="food-item">
                        <div class="food-item-info">
                            <h4>${food.description}</h4>
                            <p>Logged at ${food.time} | P: ${food.protein}g | C: ${food.carbs}g | F: ${food.fats}g</p>
                        </div>
                        <div class="food-item-calories">${food.calories} cal</div>
                    </div>
                `).join('');
            }
            
            // Update calendars
            initializeWeeklyNutritionCalendar();
            updateNutritionMonthlyCalendar();
        }

        function updateNutritionRecommendation() {
            const weight = parseFloat(profileData.weight) || 70;
            const height = parseFloat(profileData.height) || 175;
            const age = parseInt(profileData.age) || 25;
            const gender = profileData.gender || 'Male';
            
            // STEP 1: Calculate BMR using Mifflin-St Jeor equation
            let bmr;
            if (gender === 'Male') {
                bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
            } else {
                bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
            }
            
            // STEP 2: Calculate Activity Factor (70% weight - past 2 days exercise)
            const today = new Date();
            let recentWorkoutMinutes = [0, 0];
            let recentWorkoutInfo = [];
            
            for (let i = 0; i < 2; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toDateString();
                if (workoutLog[dateStr]) {
                    let dayMinutes = 0;
                    workoutLog[dateStr].forEach(w => {
                        dayMinutes += w.duration;
                        recentWorkoutInfo.push(`${w.type} (${w.intensity}, ${w.duration}min)`);
                    });
                    recentWorkoutMinutes[i] = dayMinutes;
                }
            }
            
            const avgDailyExercise = (recentWorkoutMinutes[0] + recentWorkoutMinutes[1]) / 2;
            const activityFactor = (avgDailyExercise / 30) * 0.175; // 0.175 per 30 min of moderate activity
            
            // STEP 3: Get Future Goal Multiplier (30% weight)
            const fitnessGoal = document.getElementById('fitnessGoalSelect')?.value || 'maintain';
            let goalMultiplier;
            switch(fitnessGoal) {
                case 'weight-loss':
                    goalMultiplier = 0.85; // 15% deficit
                    break;
                case 'muscle-gain':
                    goalMultiplier = 1.15; // 15% surplus
                    break;
                case 'maintain':
                default:
                    goalMultiplier = 1.00; // No change
                    break;
            }
            
            // STEP 4: Apply Custom Formula
            // Daily Calories = BMR √ó (1 + Activity_Factor) √ó Goal_Multiplier
            const recommendedCalories = Math.round(bmr * (1 + activityFactor) * goalMultiplier);
            
            // Display recommendation with breakdown
            const recommendation = document.getElementById('nutritionRecommendation');
            
            let goalText = '';
            if (fitnessGoal === 'weight-loss') {
                goalText = ' for weight loss';
            } else if (fitnessGoal === 'muscle-gain') {
                goalText = ' for muscle gain';
            } else {
                goalText = ' for maintenance';
            }
            
            let recentWorkoutText = '';
            if (avgDailyExercise > 0) {
                recentWorkoutText = `Your recent activity: averaging <strong>${Math.round(avgDailyExercise)} minutes/day</strong> over the past 2 days. `;
                if (recentWorkoutInfo.length > 0) {
                    recentWorkoutText += `(${recentWorkoutInfo.slice(0, 2).join(', ')}) `;
                }
            } else {
                recentWorkoutText = 'No workouts logged in the past 2 days. ';
            }
            
            recommendation.innerHTML = `
                <strong>Personalized AI Recommendation: ${recommendedCalories} calories/day${goalText}</strong>
                <br><br>
                üìä <strong>Calculation Breakdown:</strong><br>
                ‚Ä¢ Base Metabolism (BMR): ${Math.round(bmr)} cal<br>
                ‚Ä¢ Activity Boost (70% weight): +${Math.round(bmr * activityFactor)} cal (${Math.round(avgDailyExercise)} min/day avg)<br>
                ‚Ä¢ Goal Adjustment (30% weight): √ó${goalMultiplier} multiplier<br>
                <br>
                ${recentWorkoutText}
                <br>
                <em>This recommendation heavily weighs your recent measurable activity (70%) with a light adjustment for your stated goals (30%).</em>
            `;
        }

        function saveNutritionGoals() {
            const daily = parseInt(document.getElementById('customDailyCalories').value);
            const weekly = parseInt(document.getElementById('customWeeklyCalories').value);
            const monthly = parseInt(document.getElementById('customMonthlyCalories').value);
            
            if (daily && weekly && monthly) {
                nutritionGoals = { daily, weekly, monthly };
                document.getElementById('displayDailyCalories').textContent = daily + ' calories';
                document.getElementById('displayWeeklyCalories').textContent = weekly + ' calories';
                document.getElementById('displayMonthlyCalories').textContent = monthly + ' calories';
                document.getElementById('dailyCalorieGoalDisplay').textContent = daily;
                document.getElementById('weeklyCalorieGoalDisplay').textContent = weekly;
                document.getElementById('monthlyCalorieGoalDisplay').textContent = monthly;
                updateNutritionDisplay();
                alert('Nutrition goals saved successfully!');
            }
        }

        function initializeWeeklyNutritionCalendar() {
            const calendar = document.getElementById('weeklyNutritionCalendar');
            calendar.innerHTML = '';
            
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const today = new Date();
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toDateString();
                
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                if (i === 0) dayDiv.classList.add('today');
                
                let dayCalories = 0;
                if (foodLog[dateStr]) {
                    foodLog[dateStr].forEach(food => {
                        dayCalories += food.calories;
                    });
                    dayDiv.classList.add('has-data');
                }
                
                dayDiv.innerHTML = `
                    <div class="calendar-day-label">${days[date.getDay()]}</div>
                    <div class="calendar-day-number">${date.getDate()}</div>
                    <div class="calendar-day-value">${dayCalories > 0 ? dayCalories + ' cal' : '-'}</div>
                `;
                
                calendar.appendChild(dayDiv);
            }
        }

        function updateNutritionMonthlyCalendar() {
            const calendar = document.getElementById('monthlyNutritionCalendar');
            const monthSelector = document.getElementById('nutritionMonthSelector');
            const selectedMonth = parseInt(monthSelector.value);
            const year = new Date().getFullYear();
            
            calendar.innerHTML = '';
            
            const daysInMonth = new Date(year, selectedMonth + 1, 0).getDate();
            const firstDay = new Date(year, selectedMonth, 1).getDay();
            
            for (let i = 0; i < firstDay; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day';
                emptyDiv.style.opacity = '0.3';
                calendar.appendChild(emptyDiv);
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, selectedMonth, day);
                const dateStr = date.toDateString();
                
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                
                const today = new Date();
                if (date.toDateString() === today.toDateString()) {
                    dayDiv.classList.add('today');
                }
                
                let dayCalories = 0;
                if (foodLog[dateStr]) {
                    foodLog[dateStr].forEach(food => {
                        dayCalories += food.calories;
                    });
                    dayDiv.classList.add('has-data');
                }
                
                dayDiv.innerHTML = `
                    <div class="calendar-day-number">${day}</div>
                    <div class="calendar-day-value">${dayCalories > 0 ? dayCalories + ' cal' : '-'}</div>
                `;
                
                calendar.appendChild(dayDiv);
            }
        }

        function updateWorkoutCalendar() {
            const calendar = document.getElementById('workoutCalendar');
            const monthSelector = document.getElementById('workoutMonthSelector');
            const selectedMonth = parseInt(monthSelector.value);
            const year = new Date().getFullYear();
            
            calendar.innerHTML = '';
            
            const daysInMonth = new Date(year, selectedMonth + 1, 0).getDate();
            const firstDay = new Date(year, selectedMonth, 1).getDay();
            
            for (let i = 0; i < firstDay; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'calendar-day';
                emptyDiv.style.opacity = '0.3';
                calendar.appendChild(emptyDiv);
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, selectedMonth, day);
                const dateStr = date.toDateString();
                
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                
                const today = new Date();
                if (date.toDateString() === today.toDateString()) {
                    dayDiv.classList.add('today');
                }
                if (workoutLog[dateStr]) {
                    dayDiv.classList.add('has-data');
                }
                
                const totalMinutes = workoutLog[dateStr] ? 
                    workoutLog[dateStr].reduce((sum, w) => sum + w.duration, 0) : 0;
                
                dayDiv.innerHTML = `
                    <div class="calendar-day-number">${day}</div>
                    ${workoutLog[dateStr] ? '<div class="workout-indicator"></div>' : ''}
                    <div class="calendar-day-value">${totalMinutes > 0 ? totalMinutes + ' min' : '-'}</div>
                `;
                
                calendar.appendChild(dayDiv);
            }
        }

        // Profile Photo Upload
        function handleDragOver(event) {
            event.preventDefault();
            event.stopPropagation();
            document.getElementById('profileAvatar').classList.add('dragging');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            event.stopPropagation();
            document.getElementById('profileAvatar').classList.remove('dragging');
        }

        function handleDrop(event) {
            event.preventDefault();
            event.stopPropagation();
            document.getElementById('profileAvatar').classList.remove('dragging');
            
            const files = event.dataTransfer.files;
            if (files.length > 0 && files[0].type.startsWith('image/')) {
                displayProfilePhoto(files[0]);
            } else {
                alert('Please drop a valid image file');
            }
        }

        function handleFileSelect(event) {
            const files = event.target.files;
            if (files.length > 0) {
                displayProfilePhoto(files[0]);
            }
        }

        function displayProfilePhoto(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const avatar = document.getElementById('profileAvatar');
                const avatarText = document.getElementById('avatarText');
                
                // Check if img already exists
                let img = avatar.querySelector('img');
                if (!img) {
                    img = document.createElement('img');
                    avatar.appendChild(img);
                }
                
                img.src = e.target.result;
                avatarText.style.display = 'none';
            };
            reader.readAsDataURL(file);
        }
    </script>
</body>
</html>
